@{
    ViewData["Title"] = "後台中心";
    Layout = "~/Areas/BackCenter/Views/Shared/_Layout.cshtml";
}
<div class="container-fluid p-5" id="dataMain">
    <h3>後臺首頁</h3>
    <hr>
    <div class="data py-4">
        <h3>營運總覽</h3>
        <div class="dataarea row-cols-4">
            <div class="datadetail p-4"><h2>{{main.total}}</h2><h5>營業額</h5></div>
            <div class="datadetail p-4"><h2>{{main.guestNum}}</h2><h5>來客量</h5></div>
            <div class="datadetail p-4"><h2>{{main.memberNum}}</h2><h5>新增會員數</h5></div>
            <div class="datadetail p-4"><h2>{{main.rate}}/5</h2><h5>當前評價</h5></div>
        </div>
    </div>
    <div class="data py-4">
        <div class="spacebetween row-cols-2 mb-3">
            <h3>累計數據</h3>
            <select class="form-select" name="mark" id="mark" v-model="diff" v-on:change="selectDiff">
                <option value="w">近七日</option>
                <option value="m">近一個月</option>
                <option value="s">近一季</option>
                <option value="y">近一年</option>
            </select>
        </div>
        <div class="dataarea row-cols-4">
            <div class="datadetail p-4"><h2>{{select.sTotal}}</h2><h5>營業額</h5></div>
            <div class="datadetail p-4"><h2>{{select.sGuestNum}}</h2><h5>來客量</h5></div>
            <div class="datadetail p-4"><h2>{{select.sMemberNum}}</h2><h5>會員數</h5></div>
            <div class="datadetail p-4"><h2>{{select.sRate}}/5</h2><h5>評價</h5></div>
        </div>
    </div>
    <div class="data py-4">
        <h3>熱賣商品</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>排序</th>
                    <th>商品照片</th>
                    <th>商品名稱</th>
                    <th>銷售件數</th>
                </tr>
            </thead>
            <tbody>
                <template v-for="(item,index) in main.hotSales">
                    <tr>
                        <td>{{index+1}}</td>
                        <td><img :src="item.imgPath" alt=""></td>
                        <td>{{item.productName}}</td>
                        <td>{{item.quantity}}</td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>
</div>
<script>
    const vdMain = new Vue({
        el: "#dataMain",
        data:{
            main:[],
            select:{},
            diff:"w",
        },
        methods:{
            selectDiff: function () {
                fetch("/backcenter/back/SelectedData",{
                    method:"post",
                    headers:{"Content-Type":"application/json"},
                    body: JSON.stringify(this.diff)
                }).then(e => e.json()).then(r => this.select = r)        
            }
        },
        mounted:function(){
            let self = this;
            fetch("/backcenter/back/HomePageData").then(e => e.json()).then(r => self.main = r);
            this.selectDiff();
        }
    })
</script>