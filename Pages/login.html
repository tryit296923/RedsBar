<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登入&註冊</title>
    <link rel="stylesheet" href="bootstrap/originalBS/bootstrap.css">
    <link rel="stylesheet" href="sweetalert/sweetalert2.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="bootstrap/bootstrap.bundle.min.js"></script>
    <script src="sweetalert/sweetalert2.min.js"></script>
    <script src="vue/vue.min.js"></script>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        a{
            text-decoration: none;
        }
        body{
            background-color: #222220;
            position: relative;
            min-height: 844px;
            min-width: 390px;
        }
        input{
            border: 0px;
            border-radius: 00.375rem;
            padding: 4px;
            width: 130%;
        }
        .tab-content button{
            box-shadow: 4px 4px 4px #666;
            padding: 4px;
        }
        .loginpage, .registerpage{
            height: 100%;
        }
        /* nav */
        .nav{
            width: 390px;
            position: absolute;
            z-index: 1;
            display: flex;
            justify-content: center;
            top: 10%;
        }
        /* LoginForm */
        .loginpage{
            position: relative;
            background-image: url("Images/BackGround/LoginForm.jpg");
            background-repeat: no-repeat;
            background-size: cover;
            height: 844px;
            width: 390px;
        }
        #Login a{
            position: absolute;
            right: 24%;
            top: 54%;
            font-size: 1rem;
        }
        .account{
            position: absolute;
            top: 38%;
            left: 20%;
        }
        .password{
            position: absolute;
            top: 49%;
            left: 20%;
        }
        .login{
            width: 100%;
            display: flex;
            justify-content: center;
        }
        .login button{
            position: absolute;
            top: 60%;
            width: 50%;
            border-radius: 00.375rem;
            border: 0px;
            background-color: #721B29;
            color: #fff;
        }
        .OAuth{
            width: 100%;
            display: flex;
            justify-content: center;
            position: absolute;
            bottom: 14%;
        }
        .OAuth a img{
            padding: 14px;
        }
        /* RegisterForm */
        .registerpage{
            position: relative;
            background-image: url("Images/BackGround/RegisterForm.jpg");
            background-repeat: no-repeat;
            background-size: cover;
            height: 844px;
            width: 390px;
        }
        .Register{
            height: 416px;
            position: absolute;
            left: 20%;
            margin-top: 72%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .register{
            width: 100%;
            display: flex;
            justify-content: center;
        }
        .register button{
            position: absolute;
            bottom: 10%;
            width: 50%;
            border-radius: 00.375rem;
            border: 0px;
            background-color: #721B29;
            color: #fff;
        }
        .valid{
            background-color: #D8CDB9;
        }
        .incorrectText{
            position: absolute;
            color: #D8CDB9;
            top: 24%;
            left: 80%;
            font-weight: bold;
            width: 200px;
        }
        @media screen and (min-width: 768px) {
            body{
                background-color: #222220;
                position: relative;
                font-size: 1.5rem;
            }
            input{
                width: 170%;
            }
            .loginpage{
                position: relative;
                background-image: url("Images/BackGround/Login.jpg");
                background-repeat: no-repeat;
                background-size: cover;
                height: 1060px;
                width: 768px;
            }
            .registerpage{
                position: relative;
                background-image: url("Images/BackGround/Register.jpg");
                background-repeat: no-repeat;
                background-size: cover;
                height: 1060px;
                width: 768px;
            }
            .nav{
                width: 768px;
                top: 8%;
            }
            .Register{
                height: 464px;
                left: 32%;
                margin-top: 48%;
            }
            .account{
                top: 39%;
            }
            .password{
                top: 49%;
            }
            .OAuth{
                bottom: 8%;                
            }
            .OAuth a img{
                margin: 8px;
                height: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="pageselect">
        <ul class="nav nav-pills" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">登入</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">註冊</button>
            </li>
        </ul>        
    </div>       
    <div class="tab-content " id="pills-tabContent">
        <div class="loginpage m-0 tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab" tabindex="0">
            <form id="Login" asp-controller="MemberApi" asp-action="Login" method="post" enctype="multipart/form-data">
                <div class="account">
                    <input type="account" required maxlength="20" minlength="8" placeholder="請輸入帳號(8~20字)">                    
                </div>
                <div class="password">
                    <input type="password" required maxlength="20" minlength="8" placeholder="請輸入密碼(8~20字)">                    
                </div>
                <a href="">忘記密碼?</a>
                <div class="login">
                    <button>登 入</button>
                </div>
            </form>                
            <div class="OAuth">
                <a href=""><img src="Images/icons/google.png" alt=""></a>
                <a href=""><img src="Images/icons/IG.png" alt=""></a>
                <a href=""><img src="Images/icons/FB.png" alt=""></a>
            </div>
        </div>
        <div class="registerpage tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab" tabindex="0">
            <div id="Register">
                <form class="Register" method="post" enctype="">
                    <div class="text">
                        <input v-model="Account" required maxlength="20" minlength="8" placeholder="請輸入帳號(8~20字)">
                    </div>
                    <div class="encryp">
                        <input v-model="Password" type="password" required maxlength="20" minlength="8" placeholder="請輸入密碼(8~20字)">
                    </div>
                    <div class="repassword">
                        <input v-model="rePassword" v-bind:class="incorrect" type="password" required maxlength="20" minlength="8" placeholder="請再次輸入密碼">
                    </div>
                    <div class="Email">
                        <input v-model.lazy="Email" v-bind:class="validEmail" type="email" required>
                    </div>
                    <div class="name">
                        <input v-model="Name" required maxlength="20">
                    </div>
                    <div class="phone">
                        <input v-model="Phone" required maxlength="10" minlength="10" placeholder="請輸入連絡電話(09-開頭)">
                    </div>
                    <div class="birth">
                        <input v-model="Birth" type="date" value="2000-12-10" required>
                    </div>    
                    <div class="incorrectText" v-bind:style="incorrectText">
                        <p>兩次密碼不相符!</p>
                    </div>
                </form>
                <div class="register">
                    <button v-on:click.prevent="login" class="registerbtn" >註 冊</button>
                </div>
            </div>
        </div>
    </div>

</body>
<script>
    const vm = new Vue({
        el:"#Register",
        data:{
            Account:"",
            Password:"",
            Name:"",
            Birth:"2000-02-02",
            Phone:"",
            Email:"",
            rePassword:"",
            incorrect:"",
            incorrectText:{'opacity': 0},
            validEmail:""
        },
        watch:{
            rePassword:function(){
                this.incorrect = this.Password != this.rePassword? "valid":"";
                this.incorrectText = this.Password != this.rePassword? {}:{'opacity': 0};
            },
            Password:function(){
                this.incorrect = this.Password != this.rePassword? "valid":"";
                this.incorrectText = this.Password != this.rePassword? {}:{'opacity': 0};
            },
            Email:function(){
                this.validEmail = this.Email.includes("@")? "":"valid"
            }
        },
        methods:{
            login: function () {
                let fbody = {
                    "MemberID": "",
                    "MemberAccount": this.Account,
                    "MemberPassword": this.Password,
                    "MemberName": this.Name,
                    "MemberBirth": this.Birth,
                    "Phone": this.Phone,
                    "Email": this.Email,
                };
                let JsonString = JSON.stringify(fbody);
                console.log(JsonString);    // JSON
                console.log(fbody);         // Obj
                fetch("https://localhost:7273/api/Register", {
                    method: 'POST',
                    headers: { "Content-Type": "application/json" },
                    body: JsonString        // to JsonString
                })
                .then(() => Swal.fire({
                    icon: 'success',
                    title: '註冊成功!',
                    text: '請至信箱收取認證信件，請稍待1~3分鐘',
                    footer: '<a href="https://localhost:7273/Member/Authorize">未收到信件? 點擊此處以重發</a>'
                }))
                    .catch(error => console.error(error))
            },
        }
    })
</script>
</html>